"""Tests standard tap features using the built-in SDK tests library."""

import datetime
import pytest
#from singer_sdk.testing import get_standard_tap_tests
from target_mysql.target import TargetMSSQL

#Config from Docker File Setup
SAMPLE_CONFIG = {
  "start_date": datetime.datetime.now(datetime.timezone.utc).strftime("%Y-%m-%d"),
  "host": "localhost",
  "port": 3306,
  "database": "test",
  "user": "root",
  "password": "root",
  "batch_size": 1

}


# Run standard built-in tap tests from the SDK:
# def test_standard_tap_tests():
#    """Run standard tap tests from the SDK."""
#    tests = get_standard_tap_tests(
#        TargetMSSQL,
#        config=SAMPLE_CONFIG
#    )
#    for test in tests:
#        test()

# TODO: State of MSSQL database does need to be handled before going too far here
def testdata_to_mssql(source_data):
  target = TargetMSSQL(config=SAMPLE_CONFIG)
  target.process_messages(source_data.splitlines()); #test data

@pytest.fixture
def source_data():
  data  = """\
{"type": "SCHEMA", "stream": "employees", "schema": {"type": "object", "properties": {"id": {"type": ["string", "null"]}, "displayName": {"type": ["string", "null"]}, "firstName": {"type": ["string", "null"]}, "lastName": {"type": ["string", "null"]}, "gender": {"type": ["string", "null"]}, "jobTitle": {"type": ["string", "null"]}, "workPhone": {"type": ["string", "null"]}, "workPhoneExtension": {"type": ["string", "null"]}, "skypeUsername": {"type": ["string", "null"]}, "preferredName": {"type": ["string", "null"]}, "mobilePhone": {"type": ["string", "null"]}, "workEmail": {"type": ["string", "null"]}, "department": {"type": ["string", "null"]}, "location": {"type": ["string", "null"]}, "division": {"type": ["string", "null"]}, "linkedIn": {"type": ["string", "null"]}, "photoUploaded": {"type": ["boolean", "null"]}, "photoUrl": {"type": ["string", "null"]}, "canUploadPhoto": {"type": ["number", "null"]}}, "required": []}, "key_properties": ["id"]}
  {"type": "RECORD", "stream": "employees", "record": {"id": "119", "displayName": "Alexa Aberdean", "firstName": "Alexa", "lastName": "Aberdean", "preferredName": null, "jobTitle": "CNC Machinist", "workPhone": null, "mobilePhone": null, "workEmail": "aaberdean@autoidm.com", "department": "Customer Experience", "location": "Kalamazoo", "division": "abc", "linkedIn": null, "workPhoneExtension": null, "photoUploaded": false, "photoUrl": "https://resources.bamboohr.com/images/photo_person_150x150.png", "canUploadPhoto": 1}, "time_extracted": "2021-04-15T19:16:24.878203Z"}
  {"type": "STATE", "value": {"bookmarks": {"employees": {}}}}
  {"type": "RECORD", "stream": "employees", "record": {"id": "120", "displayName": "Lisa Boyer", "firstName": "Lisa", "lastName": "Boyer", "preferredName": null, "jobTitle": "HR Generalist", "workPhone": null, "mobilePhone": null, "workEmail": null, "department": "Human Resources", "location": "Kalamazoo", "division": null, "linkedIn": null, "workPhoneExtension": null, "photoUploaded": false, "photoUrl": "https://resources.bamboohr.com/images/photo_person_150x150.png", "canUploadPhoto": 1}, "time_extracted": "2021-04-15T19:16:24.878919Z"}
  {"type": "RECORD", "stream": "employees", "record": {"id": "117", "displayName": "Abby Lamar", "firstName": "Abby", "lastName": "Lamar", "preferredName": null, "jobTitle": "Customer Experience Champion", "workPhone": null, "mobilePhone": null, "workEmail": null, "department": "Customer Experience", "location": "Kalamazoo", "division": null, "linkedIn": null, "workPhoneExtension": null, "photoUploaded": false, "photoUrl": "https://resources.bamboohr.com/images/photo_person_150x150.png", "canUploadPhoto": 1}, "time_extracted": "2021-04-15T19:16:24.879049Z"}
  {"type": "RECORD", "stream": "employees", "record": {"id": "111", "displayName": "Patty Mae", "firstName": "Patty", "lastName": "Mae", "preferredName": null, "jobTitle": "Executive", "workPhone": null, "mobilePhone": null, "workEmail": "b@autoidm.com", "department": "Leadership", "location": "Kalamazoo", "division": null, "linkedIn": null, "workPhoneExtension": null, "photoUploaded": false, "photoUrl": "https://resources.bamboohr.com/images/photo_person_150x150.png", "canUploadPhoto": 1}, "time_extracted": "2021-04-15T19:16:24.879185Z"}
  {"type": "RECORD", "stream": "employees", "record": {"id": "122", "displayName": "Mickey Mouse", "firstName": "Mickey", "lastName": "Mouse", "preferredName": null, "jobTitle": "CNC Programmer", "workPhone": null, "mobilePhone": null, "workEmail": null, "department": "Engineering", "location": "Kalamazoo", "division": null, "linkedIn": null, "workPhoneExtension": null, "photoUploaded": false, "photoUrl": "https://resources.bamboohr.com/images/photo_person_150x150.png", "canUploadPhoto": 1}, "time_extracted": "2021-04-15T19:16:24.879338Z"}
  {"type": "RECORD", "stream": "employees", "record": {"id": "115", "displayName": "Elon Musky", "firstName": "Elon", "lastName": "Musky", "preferredName": null, "jobTitle": "Process Engineer", "workPhone": null, "mobilePhone": null, "workEmail": null, "department": "Engineering", "location": "Kalamazoo", "division": null, "linkedIn": null, "workPhoneExtension": null, "photoUploaded": false, "photoUrl": "https://resources.bamboohr.com/images/photo_person_150x150.png", "canUploadPhoto": 1}, "time_extracted": "2021-04-15T19:16:24.879454Z"}
  {"type": "RECORD", "stream": "employees", "record": {"id": "116", "displayName": "Jeff Razer", "firstName": "Jeff", "lastName": "Razer", "preferredName": null, "jobTitle": "Customer Experience Champion", "workPhone": null, "mobilePhone": null, "workEmail": null, "department": "Customer Experience", "location": "Kalamazoo", "division": null, "linkedIn": null, "workPhoneExtension": null, "photoUploaded": false, "photoUrl": "https://resources.bamboohr.com/images/photo_person_150x150.png", "canUploadPhoto": 1}, "time_extracted": "2021-04-15T19:16:24.879566Z"}
  {"type": "RECORD", "stream": "employees", "record": {"id": "113", "displayName": "Tyler Sawyer", "firstName": "Tyler", "lastName": "Sawyer", "preferredName": null, "jobTitle": "Marketing Analyst", "workPhone": "5555555555", "mobilePhone": null, "workEmail": null, "department": "Sales/Marketing", "location": "Kalamazoo", "division": null, "linkedIn": null, "workPhoneExtension": "1", "photoUploaded": false, "photoUrl": "https://resources.bamboohr.com/images/photo_person_150x150.png", "canUploadPhoto": 1}, "time_extracted": "2021-04-15T19:16:24.879670Z"}
  {"type": "RECORD", "stream": "employees", "record": {"id": "110", "displayName": "Sam Smith", "firstName": "Sam", "lastName": "Smith", "preferredName": null, "jobTitle": "Sales Representative", "workPhone": null, "mobilePhone": "1234567891", "workEmail": "ssmith@autoidm.com", "department": "Sales/Marketing", "location": "Kalamazoo", "division": null, "linkedIn": null, "workPhoneExtension": null, "photoUploaded": false, "photoUrl": "https://resources.bamboohr.com/images/photo_person_150x150.png", "canUploadPhoto": 1}, "time_extracted": "2021-04-15T19:16:24.879805Z"}
  {"type": "RECORD", "stream": "employees", "record": {"id": "114", "displayName": "Tim Teebow", "firstName": "Tim", "lastName": "Teebow", "preferredName": null, "jobTitle": "Network Engineer", "workPhone": null, "mobilePhone": null, "workEmail": null, "department": "Engineering", "location": "Kalamazoo", "division": null, "linkedIn": null, "workPhoneExtension": null, "photoUploaded": false, "photoUrl": "https://resources.bamboohr.com/images/photo_person_150x150.png", "canUploadPhoto": 1}, "time_extracted": "2021-04-15T19:16:24.879902Z"}
  {"type": "RECORD", "stream": "employees", "record": {"id": "121", "displayName": "Jake Vicks", "firstName": "Jake", "lastName": "Vicks", "preferredName": null, "jobTitle": "CNC Machinist", "workPhone": null, "mobilePhone": null, "workEmail": null, "department": "Engineering", "location": "Kalamazoo", "division": null, "linkedIn": null, "workPhoneExtension": null, "photoUploaded": false, "photoUrl": "https://resources.bamboohr.com/images/photo_person_150x150.png", "canUploadPhoto": 1}, "time_extracted": "2021-04-15T19:16:24.879997Z"}
  {"type": "STATE", "value": {"bookmarks": {"employees": {}}}}
  {"type": "RECORD", "stream": "employees", "record": {"id": "109", "displayName": "Derek Visch", "firstName": "Derek", "lastName": "Visch", "preferredName": null, "jobTitle": "Executive", "workPhone": null, "mobilePhone": null, "workEmail": "dvisch@autoidm.com", "department": "Leadership", "location": "Kalamazoo", "division": null, "linkedIn": null, "workPhoneExtension": null, "photoUploaded": false, "photoUrl": "https://resources.bamboohr.com/images/photo_person_150x150.png", "canUploadPhoto": 1}, "time_extracted": "2021-04-15T19:16:24.880110Z"}
  {"type": "RECORD", "stream": "employees", "record": {"id": "118", "displayName": "Lexi Weatherton", "firstName": "Lexi", "lastName": "Weatherton", "preferredName": null, "jobTitle": "CNC Machinist", "workPhone": null, "mobilePhone": null, "workEmail": null, "department": "Manufacturing", "location": "Kalamazoo", "division": null, "linkedIn": null, "workPhoneExtension": null, "photoUploaded": false, "photoUrl": "https://resources.bamboohr.com/images/photo_person_150x150.png", "canUploadPhoto": 1}, "time_extracted": "2021-04-15T19:16:24.880206Z"}
  {"type": "STATE", "value": {"bookmarks": {"employees": {}}}}"""

  data2 = """\
  {"type": "SCHEMA", "stream": "ext_sales-v_dim_lead_us3", "schema": {"type": "object", "properties": {"dw_lead_type": {"type": ["null", "string"]}, "record_type_name": {"type": ["null", "string"]}, "id": {"type": ["null", "string"]}, "created_date": {"type": ["null", "string"], "format": "date-time"}, "lastmodified_date": {"type": ["null", "string"], "format": "date-time"}, "reached_date": {"type": ["null", "string"], "format": "date-time"}, "status": {"type": ["null", "string"]}, "reason_for_closing": {"type": ["null", "string"]}, "act": {"type": ["null", "string"]}, "country_code_iso3": {"type": ["null", "string"]}, "number_of_unsuccessful_attempts": {"type": ["null", "number"], "exclusiveMaximum": true, "maximum": 100000000000000000000000000000000000000000000000000000000000000, "multipleOf": 1e-38, "exclusiveMinimum": true, "minimum": -100000000000000000000000000000000000000000000000000000000000000}, "source": {"type": ["null", "string"]}, "age": {"type": ["null", "number"], "exclusiveMaximum": true, "maximum": 100000000000000000000000000000000000000000000000000000000000000, "multipleOf": 1e-38, "exclusiveMinimum": true, "minimum": -100000000000000000000000000000000000000000000000000000000000000}, "created_during_office_hours": {"type": ["null", "boolean"]}, "user_device": {"type": ["null", "string"]}, "owned_by_consultant_id": {"type": ["null", "string"]}, "assigned_team": {"type": ["null", "string"]}, "t_parameter": {"type": ["null", "string"]}, "doi_status": {"type": ["null", "string"]}, "donotcall": {"type": ["null", "boolean"]}, "sub_publisher": {"type": ["null", "string"]}, "distance_to_intital_nearest_partner": {"type": ["null", "number"], "exclusiveMaximum": true, "maximum": 100000000000000000000000000000000000000000000000000000000000000, "multipleOf": 1e-38, "exclusiveMinimum": true, "minimum": -100000000000000000000000000000000000000000000000000000000000000}, "lead_url": {"type": ["null", "string"]}, "created_by": {"type": ["null", "string"]}, "lead_score_initial": {"type": ["null", "number"], "exclusiveMaximum": true, "maximum": 100000000000000000000000000000000000000000000000000000000000000, "multipleOf": 1e-38, "exclusiveMinimum": true, "minimum": -100000000000000000000000000000000000000000000000000000000000000}, "closing_category": {"type": ["null", "string"]}, "owner_team_role": {"type": ["null", "string"]}, "isblacklisted": {"type": ["null", "boolean"]}, "cosi_basic_type_1": {"type": ["null", "string"]}, "cosi_basic_type_2": {"type": ["null", "string"]}, "cosi_basic_type_3": {"type": ["null", "string"]}, "cosi_basic_subtype_1": {"type": ["null", "string"]}, "cosi_basic_subtype_2": {"type": ["null", "string"]}, "cosi_basic_subtype_3": {"type": ["null", "string"]}, "cosi_basic_remark_1": {"type": ["null", "string"]}, "cosi_basic_remark_2": {"type": ["null", "string"]}, "cosi_basic_remark_3": {"type": ["null", "string"]}, "vorqualifizierung_von": {"type": ["null", "string"]}, "recommended_by": {"type": ["null", "string"]}, "ad_id": {"type": ["null", "string"]}, "section_id": {"type": ["null", "string"]}, "bswcode": {"type": ["null", "string"]}, "hearing_test_with": {"type": ["null", "string"]}, "responsiblesubteam": {"type": ["null", "string"]}, "iso_language_code": {"type": ["null", "string"]}, "region": {"type": ["null", "string"]}, "state": {"type": ["null", "string"]}, "dw_source_modified_at": {"type": ["null", "string"], "format": "date-time"}, "gid": {"type": ["null", "string"]}, "publisher_id": {"type": ["null", "string"]}, "credit_score": {"type": ["null", "string"]}, "swat": {"type": ["null", "boolean"]}, "desired_call_back_time_filled": {"type": ["null", "boolean"]}, "initial_nearest_partner": {"type": ["null", "string"]}, "desired_callback_time": {"type": ["null", "string"], "format": "date-time"}, "initial_offer": {"type": ["null", "string"]}, "mobile_phone_number_lead": {"type": ["null", "boolean"]}, "qbht_question_1": {"type": ["null", "string"]}, "qbht_question_2": {"type": ["null", "string"]}, "qbht_question_3": {"type": ["null", "string"]}, "qbht_question_4": {"type": ["null", "string"]}, "qbht_question_5": {"type": ["null", "string"]}, "qbht_result_score": {"type": ["null", "number"], "exclusiveMaximum": true, "maximum": 100000000000000000000000000000000000000000000000000000000000000, "multipleOf": 1e-38, "exclusiveMinimum": true, "minimum": -100000000000000000000000000000000000000000000000000000000000000}, "lead_region": {"type": ["null", "string"]}, "degree_of_suffering": {"type": ["null", "string"]}, "professional_status": {"type": ["null", "string"]}, "success_page": {"type": ["null", "string"]}, "email": {"type": ["null", "string"]}, "lead_id__c": {"type": ["null", "string"]}, "landing_page_url": {"type": ["null", "string"]}, "is_mobile_phone_filled": {"type": ["null", "boolean"]}, "is_phone_filled": {"type": ["null", "boolean"]}, "converted_opportunity_id": {"type": ["null", "string"]}, "postal_code": {"type": ["null", "string"]}, "mkt_tool_id": {"type": ["null", "string"]}, "test_variation_experiment_id": {"type": ["null", "string"]}, "usage": {"type": ["null", "string"]}, "controlling_channel": {"type": ["null", "string"]}, "marketing_partner": {"type": ["null", "string"]}, "offer_type": {"type": ["null", "string"]}, "locale": {"type": ["null", "string"]}, "useragent__c": {"type": ["null", "string"]}, "type_of_treatment": {"type": ["null", "string"]}, "discreet_design": {"type": ["null", "string"]}, "updated_at": {"type": ["null", "string"], "format": "date-time"}, "phone": {"type": ["null", "string"]}, "ip_address": {"type": ["null", "string"]}}, "definitions": {"sdc_recursive_integer_array": {"type": ["null", "integer", "array"], "items": {"$ref": "#/definitions/sdc_recursive_integer_array"}}, "sdc_recursive_number_array": {"type": ["null", "number", "array"], "items": {"$ref": "#/definitions/sdc_recursive_number_array"}}, "sdc_recursive_string_array": {"type": ["null", "string", "array"], "items": {"$ref": "#/definitions/sdc_recursive_string_array"}}, "sdc_recursive_boolean_array": {"type": ["null", "boolean", "array"], "items": {"$ref": "#/definitions/sdc_recursive_boolean_array"}}, "sdc_recursive_timestamp_array": {"type": ["null", "string", "array"], "format": "date-time", "items": {"$ref": "#/definitions/sdc_recursive_timestamp_array"}}, "sdc_recursive_object_array": {"type": ["null", "object", "array"], "items": {"$ref": "#/definitions/sdc_recursive_object_array"}}}}, "key_properties": ["id"], "bookmark_properties": ["id"]}
  {"type": "RECORD", "stream": "ext_sales-v_dim_lead_us3", "record": {"act": "ACT0000023810ACT", "ad_id": "crushing970x250", "age": 98.0, "assigned_team": "West", "bswcode": null, "closing_category": "Technical", "controlling_channel": "display", "converted_opportunity_id": null, "cosi_basic_remark_1": null, "cosi_basic_remark_2": null, "cosi_basic_remark_3": null, "cosi_basic_subtype_1": "Conference", "cosi_basic_subtype_2": null, "cosi_basic_subtype_3": null, "cosi_basic_type_1": null, "cosi_basic_type_2": null, "cosi_basic_type_3": null, "country_code_iso3": "USA", "created_by": "00524000000OkxsAAC", "created_date": "2020-02-18T22:53:46+00:00", "created_during_office_hours": true, "credit_score": "Good (680-719)", "degree_of_suffering": "Severely", "desired_call_back_time_filled": false, "desired_callback_time": null, "discreet_design": "Important", "distance_to_intital_nearest_partner": 5.0, "doi_status": "Implicit opt-in", "donotcall": false, "dw_lead_type": "customer", "dw_source_modified_at": "2020-12-11T04:24:50.019656+00:00", "email": null, "gid": "001.75c41536-37ca-e084-1f98-e3b674f3b457", "hearing_test_with": null, "id": "00Q1o00000Rwk17EAB", "initial_nearest_partner": "0012400000EROsrAAH", "initial_offer": "haa-signia-secret-weapon", "ip_address": null, "is_mobile_phone_filled": true, "is_phone_filled": false, "isblacklisted": false, "iso_language_code": "eng", "landing_page_url": "https://m.cdn.hearing-aid-advice.com/signia_secret_weapon_h/?varid=-1&act=ACT0000023810ACT&utm_source=liveintent&utm_medium=display&utm_campaign=us_en_we_haa_display_liveintent_haa_signia_secret_weapon_acq_all_desk-mob-west_ACT0000023810ACT&utm_content=crushing970x250&utm_publisher=25712&li_did=ef16ebd9-f9bc-3b84-9fde-ab12661ed2d2", "lastmodified_date": "2020-02-18T23:10:01+00:00", "lead_id__c": "USA-e69f3f77-058c-0013-ab29-61b8a5a1e633", "lead_region": "USA West", "lead_score_initial": 0.49642, "lead_url": "https://m.cdn.hearing-aid-advice.com/full_page_questionnaire/?aud_p=haa_signia_secret_weapon&state=Arizona&varid=-1&act=ACT0000023810ACT&utm_source=liveintent&utm_medium=display&utm_campaign=us_en_we_haa_display_liveintent_haa_signia_secret_weapon_acq_all_desk-mob-west_ACT0000023810ACT&utm_content=crushing970x250&utm_publisher=25712&li_did=ef16ebd9-f9bc-3b84-9fde-ab12661ed2d2", "locale": "en_US", "marketing_partner": "liveintent", "mkt_tool_id": null, "mobile_phone_number_lead": false, "number_of_unsuccessful_attempts": 0.0, "offer_type": "haa_signia_secret_weapon", "owned_by_consultant_id": "00G24000000JUFjEAO", "owner_team_role": "ab_#1_US_Team", "phone": "16029439690", "postal_code": "85020", "professional_status": "Retired", "publisher_id": null, "qbht_question_1": null, "qbht_question_2": null, "qbht_question_3": null, "qbht_question_4": null, "qbht_question_5": null, "qbht_result_score": 0.0, "reached_date": "2020-02-18T22:53:49+00:00", "reason_for_closing": "low quality lead", "recommended_by": null, "record_type_name": "USA HT Customer", "region": "West", "responsiblesubteam": "NW1", "section_id": null, "source": "Web2Lead", "state": "Arizona", "status": "closed (automatically)", "sub_publisher": null, "success_page": "https://m.cdn.hearing-aid-advice.com/success_up/?aud_p=haa_signia_secret_weapon&state=Arizona&varid=-1&act=ACT0000023810ACT&utm_source=liveintent&utm_medium=display&utm_campaign=us_en_we_haa_display_liveintent_haa_signia_secret_weapon_acq_all_desk-mob-west_ACT0000023810ACT&utm_content=crushing970x250&utm_publisher=25712&li_did=ef16ebd9-f9bc-3b84-9fde-ab12661ed2d2&area-code=602", "swat": true, "t_parameter": "-1", "test_variation_experiment_id": null, "type_of_treatment": "Followup care", "updated_at": "2020-12-11T04:24:50.019656+00:00", "usage": "us_en_we_haa_display_liveintent_haa_signia_secret_weapon_acq_all_desk-mob-west", "user_device": "Desktop", "useragent__c": null, "vorqualifizierung_von": null}, "version": 1627067392782, "time_extracted": "2021-07-23T19:09:52.782387Z"}"""
  return data2
